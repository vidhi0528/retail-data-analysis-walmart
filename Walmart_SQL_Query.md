## COUNT TOTAL RECORDS?
```SQL
SELECT COUNT(*) FROM walmart1;
```

## COUNT PAYMENT METHOD AND NO. OF TRANSACTION BY EACH METHOD?
```SQL
SELECT PAYMENT_METHOD, COUNT(*) AS NO_OF_TRANSACTION 
FROM WALMART1 
GROUP BY PAYMENT_METHOD; 
```

## COUNT OF DISTINCT BRANCHES?
```SQL
SELECT COUNT(distinct BRANCH) AS NO_OF_BRANCHES
FROM WALMART1;
```

## FIND THE MAXIMUN QUANTITY SOLD?
```SQL
SELECT MAX(QUANTITY) AS MAX_QUANTITY
FROM WALMART1;
```

## FIND THE MINIMUM QUANTITY SOLD?
```SQL
SELECT MIN(QUANTITY) AS MIN_QUANTITY
FROM WALMART1;
```

## BUSINESS PROBLEM
## Q1) FIND DIFFERENT PAYMENT METHODS, NO. OF TRANSACTION AND QUANTITY SOLD BY PAYMENT METHOD?
```SQL
SELECT PAYMENT_METHOD, COUNT(*) AS NO_OF_TRANSACTION, SUM(QUANTITY) AS TOTAL_QUANTITY
FROM WALMART1
GROUP BY PAYMENT_METHOD;
```

## Q2) IDENTIFY THE HIGHEST RATED CATEGORY IN EACH BRANCH? (DISPLAY THE BRANCH CATEGORY AND AVG_RATING)
```SQL
SELECT BRANCH, CATEGORY, AVG_RATING
FROM
(SELECT BRANCH, CATEGORY, AVG(RATING) AS AVG_RATING,
RANK() OVER (PARTITION BY BRANCH ORDER BY AVG(RATING)  DESC) AS RANKS
FROM WALMART1
GROUP BY BRANCH, CATEGORY) AS RANKING
WHERE RANKS = 1;
```

##  Q3) IDENTIFY THE BUSIEST DAY FOR EACH BRANCH BASED ON THE NO. OF TRANSACTION?
```SQL
SELECT BRANCH, DAY_OF_WEEK, NO_OF_TRANSACTION
FROM(
SELECT BRANCH, dayname(DATE) AS DAY_OF_WEEK, COUNT(*) AS NO_OF_TRANSACTION,
RANK() OVER(PARTITION BY BRANCH ORDER BY COUNT(*) DESC) AS RNK
FROM WALMART1
GROUP BY BRANCH, DAYNAME(DATE)) AS RANKED
WHERE RNK =1;
```

## Q4) CALCULATE THE TOTAL QUANTITY OF ITEM SOLD PER PAYMENT METHOD?
```SQL
SELECT * FROM WALMART1;
SELECT PAYMENT_METHOD, SUM(QUANTITY) AS TOTAL_QUANTITY
FROM WALMART1
GROUP BY PAYMENT_METHOD;
```

## Q5) DETERMINE THE AVERAGE, MINIMUM AND MAXIMUM RATING OF CATEGORIES OF EACH CITY?
```SQL
SELECT CATEGORY, CITY, AVG(QUANTITY) AS AVG_QTY, MIN(QUANTITY) AS MIN_QTY, MAX(QUANTITY) AS MAX_QTY
FROM WALMART1
GROUP BY CATEGORY, CITY;
```

## Q6) CALCULATE THE TOTAL PROFIT FOR EACH CATEGORY CONSIDERING TOTAL PROFIT AS ((UNIT_PRICE) * QUANTITY * PROFIT_MARGIN)?
```SQL
SELECT CATEGORY,
SUM(TOTAL) AS TOTAL_REVENUE,
SUM(UNIT_PRICE * QUANTITY * PROFIT_MARGIN) AS TOTAL_PROFIT
FROM WALMART1
GROUP BY CATEGORY;
```

## Q7) DETERMINE THE MOST COMMON PAYMENT METHOD FOR EACH BRANCH?
```SQL
WITH CTE
AS
(SELECT BRANCH, PAYMENT_METHOD, COUNT(*) AS TOTAL_TRANS,
RANK() OVER (PARTITION BY BRANCH ORDER BY COUNT(*) DESC) AS RANKK
FROM WALMART1
GROUP BY BRANCH, PAYMENT_METHOD)
SELECT BRANCH, PAYMENT_METHOD AS PREFERED_PAYMENT_METHOD
FROM CTE
WHERE RANKK = 1;
```

## Q8) CATEGORIZE SALES INTO MORNING, AFTERNOON AND EVENING SHIFT?
```SQL
SELECT 
CASE
WHEN TIME(TIME) BETWEEN
'00:00:00' AND '11:59:59' THEN 'MORNING'
WHEN TIME(TIME) BETWEEN 
'12:00:00' AND '17:59:59' THEN 'AFTERNOON'
ELSE 'EVENING'
END AS SHIFT,
COUNT(*) AS TOTAL_TRANSACTION
FROM WALMART1
GROUP BY SHIFT
ORDER BY COUNT(*) DESC;
```

## Q9) IDENTIFY THE 5 BRANCHES WITH THE HIGHEST REVENUE DECREASE RATIO FROM LAST YEAR TO CURRENT YEAR (CURRENT YEAR 2023 AND LAST YEAR 2022)? 
## REVENUE DECREASE RATIO = LAST_YEAR_REVENUE - CURRENT_YEAR_REVENUE / LAST_YEAR_REVENUE * 100
```SQL
WITH REVENUE_BY_YEAR AS
(SELECT BRANCH, 
year(DATE) AS YEAR,
SUM(TOTAL) AS REVENUE
FROM WALMART1
WHERE YEAR(DATE) IN (2022,2023)
GROUP BY BRANCH, YEAR(DATE)
),
REVENUE_PIVOT AS
(
SELECT 
R2023.BRANCH,
R2023.REVENUE AS REVENUE_2023,
R2022.REVENUE AS REVENUE_2022,
ROUND((R2022.REVENUE-R2023.REVENUE)/R2022.REVENUE*100,2)
AS DECREASE_RATIO
FROM 
(SELECT * FROM REVENUE_BY_YEAR WHERE YEAR=2023) AS R2023
JOIN
(SELECT * FROM REVENUE_BY_YEAR WHERE YEAR=2022) AS R2022
ON R2023.BRANCH = R2022.BRANCH
)
SELECT * FROM REVENUE_PIVOT
ORDER BY DECREASE_RATIO DESC
LIMIT 5;
```